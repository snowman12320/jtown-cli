"use strict";(self["webpackChunkhello_world"]=self["webpackChunkhello_world"]||[]).push([[271],{9108:function(e,t,l){l.d(t,{Z:function(){return b}});var a=l(3396),s=l(9242),d=l(7139);const i={"aria-label":"Page navigation example"},r={class:"pagination justify-content-center"},n={class:"page-item"},o=(0,a._)("span",{"aria-hidden":"true"},"«",-1),c=[o],u=["onClick"],p={class:"page-item"},h=(0,a._)("span",{"aria-hidden":"true"},"»",-1),m=[h];function _(e,t,l,o,h,_){return(0,a.wg)(),(0,a.iD)("nav",i,[(0,a._)("ul",r,[(0,a._)("li",n,[(0,a._)("a",{onClick:t[0]||(t[0]=(0,s.iM)((e=>_.prevPage(l.pages.current_page)),["prevent"])),class:(0,d.C_)([{"text-secondary disabled":!l.pages.has_pre},"page-link"]),href:"#","aria-label":"Previous"},c,2)]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.pages.total_pages,(e=>((0,a.wg)(),(0,a.iD)("li",{class:(0,d.C_)(["page-item",{active:e===l.pages.current_page}]),key:e},[(0,a._)("a",{class:"page-link",href:"#",onClick:(0,s.iM)((t=>_.updatePage(e)),["prevent"])},(0,d.zw)(e),9,u)],2)))),128)),(0,a._)("li",p,[(0,a._)("a",{onClick:t[1]||(t[1]=(0,s.iM)((e=>_.nextPage(l.pages.current_page)),["prevent"])),class:(0,d.C_)({"text-secondary disabled":!l.pages.has_next}),href:"#","aria-label":"Next"},m,2)])])])}var g={props:["pages"],methods:{updatePage(e){this.$emit("emit-pages",e)},prevPage(e){this.pages.has_pre&&this.$emit("emit-pages",e-=1)},nextPage(e){this.pages.has_next&&this.$emit("emit-pages",e+=1)}}},f=l(89);const w=(0,f.Z)(g,[["render",_]]);var b=w},4271:function(e,t,l){l.r(t),l.d(t,{default:function(){return Ve}});var a=l(3396),s=l(9242),d=l(7139);const i=e=>((0,a.dD)("data-v-7b908f28"),e=e(),(0,a.Cn)(),e),r={class:"w-100"},n={class:"d-flex justify-content-end"},o={class:"mt-3 d-flex flex-column flex-md-row gap-1 flex-nowrap"},c={class:"flex-shrink-0"},u=i((()=>(0,a._)("option",{value:"default",selected:""}," to sift",-1))),p=i((()=>(0,a._)("option",{value:"unpaid"},"no paid",-1))),h=[u,p],m={class:"table mt-4"},_=i((()=>(0,a._)("span",null,"購買時間",-1))),g={class:""},f={class:"form-check"},w=["value","checked"],b=i((()=>(0,a._)("i",{class:"bi bi-caret-up-fill"},null,-1))),y=[b],v={class:"form-check"},O=["value","checked"],k=i((()=>(0,a._)("i",{class:"bi bi-caret-down-fill"},null,-1))),x=[k],D=i((()=>(0,a._)("th",null,"訂單編號",-1))),P=i((()=>(0,a._)("th",{class:"d-md-table-cell d-none"},"姓名",-1))),M=i((()=>(0,a._)("th",{class:"d-md-table-cell d-none"},"Email",-1))),S=i((()=>(0,a._)("th",{class:"d-md-table-cell d-none"},"購買款項",-1))),$=i((()=>(0,a._)("th",{class:"d-md-table-cell d-none"},"應付金額",-1))),C=i((()=>(0,a._)("th",{class:"d-md-table-cell d-none"},"是否付款",-1))),z=i((()=>(0,a._)("th",{width:"150"},"編輯",-1))),L={class:"d-md-table-cell d-none"},A={class:""},H={class:"d-md-table-cell d-none"},I={class:"d-md-table-cell d-none"},U=["textContent"],Z={class:"d-md-table-cell d-none"},V={class:"list-unstyled"},j={class:"text-right d-md-table-cell d-none"},E={class:"d-md-table-cell d-none"},T={class:"form-check form-switch"},q=["id","onUpdate:modelValue","onChange"],K=["for"],W={key:0},Y={key:1},F={class:"btn-group"},N=["onClick"],B=["onClick"];function G(e,t,l,i,u,p){const b=(0,a.up)("Loading"),k=(0,a.up)("OrderModal"),G=(0,a.up)("DelModal"),J=(0,a.up)("Pagination");return(0,a.wg)(),(0,a.iD)("div",r,[(0,a.Wm)(b,{active:u.isLoading},null,8,["active"]),(0,a._)("div",n,[(0,a._)("div",o,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>u.search=e),type:"search",class:"form-control",name:"",id:"","aria-describedby":"helpId",placeholder:"search order ID / DATE"},null,512),[[s.nr,u.search]]),(0,a._)("div",c,[(0,a.wy)((0,a._)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>u.filterPaid=e),class:"form-select form-select-lg",name:"",id:""},h,512),[[s.bM,u.filterPaid]])]),(0,a._)("button",{onClick:t[2]||(t[2]=t=>p.openDelOrderModal(e.item={title:"ALL"})),type:"button",class:"btn btn-danger flex-shrink-0"},"Delete ALL")])]),(0,a._)("table",m,[(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{class:"d-flex align-items-center justify-content-around d-md-flex d-none",onClick:t[5]||(t[5]=e=>u.selectSort="Height"===u.selectSort?"Low":"Height")},[_,(0,a._)("div",g,[(0,a._)("div",f,[(0,a.wy)((0,a._)("input",{class:"form-check-input d-none",type:"radio",name:"3",id:"1","onUpdate:modelValue":t[3]||(t[3]=e=>u.selectSort=e),value:u.selectSort,checked:"Low"===u.selectSort},null,8,w),[[s.G2,u.selectSort]]),(0,a._)("label",{class:(0,d.C_)(["form-check-label",{" text-primary":"Low"===u.selectSort||"default"===u.selectSort}]),for:"1"},y,2)]),(0,a._)("div",v,[(0,a.wy)((0,a._)("input",{class:"form-check-input d-none",type:"radio",name:"3",id:"2","onUpdate:modelValue":t[4]||(t[4]=e=>u.selectSort=e),value:u.selectSort,checked:"Height"===u.selectSort},null,8,O),[[s.G2,u.selectSort]]),(0,a._)("label",{class:(0,d.C_)(["form-check-label",{" text-primary":"Height"===u.selectSort||"default"===u.selectSort}]),for:"2"},x,2)])])]),D,P,M,S,$,C,z])]),(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(p.filterOrder,((t,l)=>((0,a.wg)(),(0,a.iD)("tr",{key:l,class:(0,d.C_)({"text-secondary":!t.is_paid})},[(0,a._)("td",L,(0,d.zw)(e.$filters.dateAndTime(t.create_at)),1),(0,a._)("td",A,(0,d.zw)(t.id),1),(0,a._)("td",H,(0,d.zw)(t.user.name),1),(0,a._)("td",I,[t.user?((0,a.wg)(),(0,a.iD)("span",{key:0,textContent:(0,d.zw)(t.user.email)},null,8,U)):(0,a.kq)("",!0)]),(0,a._)("td",Z,[(0,a._)("ul",V,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.products,((e,t)=>((0,a.wg)(),(0,a.iD)("li",{key:t},(0,d.zw)(e.product.title)+" - 數量："+(0,d.zw)(e.qty)+" "+(0,d.zw)(e.product.unit),1)))),128))])]),(0,a._)("td",j,(0,d.zw)(Math.floor(t.total)),1),(0,a._)("td",E,[(0,a._)("div",T,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",id:`paidSwitch${t.id}`,"onUpdate:modelValue":e=>t.is_paid=e,onChange:e=>p.updatePaid(t)},null,40,q),[[s.e8,t.is_paid]]),(0,a._)("label",{class:"form-check-label",for:`paidSwitch${t.id}`},[t.is_paid?((0,a.wg)(),(0,a.iD)("span",W,"已付款")):((0,a.wg)(),(0,a.iD)("span",Y,"未付款"))],8,K)])]),(0,a._)("td",null,[(0,a._)("div",F,[(0,a._)("button",{class:"btn btn-outline-primary btn-sm",onClick:e=>p.openModal(!1,t)}," 檢視 ",8,N),(0,a._)("button",{class:"btn btn-outline-danger btn-sm",onClick:e=>p.openDelOrderModal(t)}," 刪除 ",8,B)])])],2)))),128))])]),(0,a.Wm)(k,{order:u.tempOrder,ref:"orderModal",onUpdatePaid:p.updatePaid},null,8,["order","onUpdatePaid"]),(0,a.Wm)(G,{item:u.tempOrder,ref:"delModal",onDelItem:p.delOrder,onDelAll:t[6]||(t[6]=e=>p.delAllOrder())},null,8,["item","onDelItem"]),(0,a.wy)((0,a.Wm)(J,{pages:u.pagination,onEmitPages:p.getOrders},null,8,["pages","onEmitPages"]),[[s.F8,!u.search&&"default"===u.filterPaid]])])}var J=l(7850);const Q={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},R={class:"modal-dialog modal-xl",role:"document"},X={class:"modal-content border-0"},ee=(0,a._)("div",{class:"modal-header bg-dark text-white"},[(0,a._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,a._)("span",null,"訂單細節")]),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),te={class:"modal-body"},le={class:"row"},ae={class:"col-md-4"},se=(0,a._)("h3",null,"用戶資料",-1),de={class:"table"},ie={key:0},re=(0,a._)("th",{style:{width:"100px"}},"姓名",-1),ne=(0,a._)("th",null,"Email",-1),oe=(0,a._)("th",null,"電話",-1),ce=(0,a._)("th",null,"地址",-1),ue={class:"col-md-8"},pe=(0,a._)("h3",null,"訂單細節",-1),he={class:"table"},me=(0,a._)("th",{style:{width:"100px"}},"訂單編號",-1),_e=(0,a._)("th",null,"下單時間",-1),ge=(0,a._)("th",null,"付款時間",-1),fe={key:0},we={key:1},be=(0,a._)("th",null,"付款狀態",-1),ye={key:0,class:"text-success"},ve={key:1,class:"text-muted"},Oe=(0,a._)("th",null,"總金額",-1),ke=(0,a._)("h3",null,"選購商品",-1),xe={class:"table"},De=(0,a._)("thead",null,[(0,a._)("tr")],-1),Pe={class:"text-end"},Me={class:"modal-footer"},Se=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function $e(e,t,l,s,i,r){return(0,a.wg)(),(0,a.iD)("div",Q,[(0,a._)("div",R,[(0,a._)("div",X,[ee,(0,a._)("div",te,[(0,a._)("div",le,[(0,a._)("div",ae,[se,(0,a._)("table",de,[i.tempOrder.user?((0,a.wg)(),(0,a.iD)("tbody",ie,[(0,a._)("tr",null,[re,(0,a._)("td",null,(0,d.zw)(i.tempOrder.user.name),1)]),(0,a._)("tr",null,[ne,(0,a._)("td",null,(0,d.zw)(i.tempOrder.user.email),1)]),(0,a._)("tr",null,[oe,(0,a._)("td",null,(0,d.zw)(i.tempOrder.user.tel),1)]),(0,a._)("tr",null,[ce,(0,a._)("td",null,(0,d.zw)(i.tempOrder.user.address),1)])])):(0,a.kq)("",!0)])]),(0,a._)("div",ue,[pe,(0,a._)("table",he,[(0,a._)("tbody",null,[(0,a._)("tr",null,[me,(0,a._)("td",null,(0,d.zw)(i.tempOrder.id),1)]),(0,a._)("tr",null,[_e,(0,a._)("td",null,(0,d.zw)(e.$filters.dateAndTime(i.tempOrder.create_at)),1)]),(0,a._)("tr",null,[ge,(0,a._)("td",null,[i.tempOrder.paid_date?((0,a.wg)(),(0,a.iD)("span",fe,(0,d.zw)(e.$filters.dateAndTime(i.tempOrder.paid_date)),1)):((0,a.wg)(),(0,a.iD)("span",we))])]),(0,a._)("tr",null,[be,(0,a._)("td",null,[i.tempOrder.is_paid?((0,a.wg)(),(0,a.iD)("strong",ye,"已付款")):((0,a.wg)(),(0,a.iD)("span",ve,"尚未付款"))])]),(0,a._)("tr",null,[Oe,(0,a._)("td",null,(0,d.zw)(e.$filters.currency(i.tempOrder.total)),1)])])]),ke,(0,a._)("table",xe,[De,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.tempOrder.products,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("th",null,(0,d.zw)(t.product.title),1),(0,a._)("td",null,(0,d.zw)(t.qty)+" / "+(0,d.zw)(t.product.unit),1),(0,a._)("td",Pe,(0,d.zw)(e.$filters.currency(t.final_total)),1)])))),128))])])])])]),(0,a._)("div",Me,[Se,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:t[0]||(t[0]=t=>e.$emit("update-order",i.tempOrder))}," 確認 ")])])])],512)}var Ce=l(1339),ze={name:"orderModal",emits:["update-product"],mixins:[Ce.Z],inject:["emitter"],data(){return{status:{},modal:"",tempOrder:{},isPaid:!1}},props:{order:{type:Object,default(){return{}}}},watch:{order(){this.tempOrder=this.order,this.isPaid=this.tempOrder.is_paid}}},Le=l(89);const Ae=(0,Le.Z)(ze,[["render",$e]]);var He=Ae,Ie=l(9108),Ue={components:{Pagination:Ie.Z,DelModal:J.Z,OrderModal:He},data(){return{orders:[],isNew:!1,pagination:{},isLoading:!1,tempOrder:{},currentPage:1,search:"",filterPaid:"default",ordersAll:[],tempPage:1,selectSort:"default"}},created(){this.getOrders(),this.getOrdersAll()},computed:{filterOrder(){return!this.search&&this.filterPaid.includes("default")&&this.selectSort.includes("default")?this.orders:this.ordersAll.filter((e=>this.filterOrderByIdAndDate(e))).filter(this.getFilterPaid()).sort(this.getSelectSort())}},methods:{filterOrderByIdAndDate(e){return e.id.toLowerCase().includes(this.search.toLowerCase().trim())||this.$filters.date(e.create_at).match(this.search.trim())},getFilterPaid(){const e={unpaid:e=>!1===e.is_paid,default:()=>!0};return e[this.filterPaid||"default"]},getSelectSort(){const e={Low:(e,t)=>new Date(1e3*e.create_at)-new Date(1e3*t.create_at),Height:(e,t)=>new Date(1e3*t.create_at)-new Date(1e3*e.create_at),default:()=>0};return e[this.selectSort||"default"]},getOrders(e=1){this.currentPage=e;const t=`https://vue3-course-api.hexschool.io/api/william-api/admin/orders?page=${e}`;this.isLoading=!0,this.$http.get(t,this.tempProduct).then((e=>{this.orders=e.data.orders,this.pagination=e.data.pagination,this.isLoading=!1}))},openModal(e,t){this.tempOrder={...t},this.isNew=e;const l=this.$refs.orderModal;l.showModal()},openDelOrderModal(e){this.tempOrder={...e},e.title||(this.tempOrder.title=this.tempOrder.id);const t=this.$refs.delModal;t.showModal()},updatePaid(e){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/william-api/admin/order/${e.id}`,l={is_paid:e.is_paid};this.$http.put(t,{data:l}).then((e=>{this.isLoading=!1,this.getOrders(this.currentPage),this.$httpMessageState(e,"更新付款狀態")}))},delOrder(){const e=`https://vue3-course-api.hexschool.io/api/william-api/admin/order/${this.tempOrder.id}`;this.isLoading=!0,this.$http.delete(e).then((e=>{const t=this.$refs.delModal;t.hideModal(),this.getOrders(this.currentPage),this.$httpMessageState(e,"delete")}))},getOrdersAll(){const e=`https://vue3-course-api.hexschool.io/api/william-api/admin/orders?page=${this.tempPage}`;this.$http.get(e,this.tempProduct).then((e=>{this.ordersAll=this.ordersAll.concat(e.data.orders),this.tempPage<this.pagination.total_pages?(this.tempPage++,this.getOrdersAll()):console.log("getOrdersAll,random success",new Date(1e3*this.ordersAll[11].create_at).toISOString().split("T")[0])}))},delAllOrder(){const e="https://vue3-course-api.hexschool.io/api/william-api/admin/order/allll";this.isLoading=!0,this.$http.delete(e).then((e=>{const t=this.$refs.delModal;t.hideModal(),this.getOrders(this.currentPage),this.$httpMessageState(e,"delete all")}))}}};const Ze=(0,Le.Z)(Ue,[["render",G],["__scopeId","data-v-7b908f28"]]);var Ve=Ze}}]);
//# sourceMappingURL=271.195774f5.js.map