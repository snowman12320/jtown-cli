"use strict";(self["webpackChunkhello_world"]=self["webpackChunkhello_world"]||[]).push([[770],{9156:function(t,e,l){l.r(e),l.d(e,{default:function(){return yt}});var a=l(3396),s=l(7139);const o={class:"w-100"},i={class:"text-end mt-3"},n={class:"table mt-4"},d=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{class:"d-md-table-cell d-none",width:"120"},"日期"),(0,a._)("th",{class:"",width:"120"},"標題"),(0,a._)("th",{class:"d-md-table-cell d-none",width:"120"},"作者"),(0,a._)("th",{class:"d-md-table-cell d-none",width:"120"},"內容"),(0,a._)("th",{class:"d-md-table-cell d-none",width:"100"},"是否啟用"),(0,a._)("th",{class:"",width:"150"},"編輯")])],-1),r={class:"d-md-table-cell d-none"},c={class:""},p={class:"d-md-table-cell d-none"},u=["innerHTML"],m={class:"d-md-table-cell d-none"},h={key:0,class:"text-success"},y={key:1,class:"text-muted"},g={class:"text-center"},_={class:"btn-group"},b=["onClick"],f=["onClick"];function w(t,e,l,w,S,v){const x=(0,a.up)("Loading"),k=(0,a.up)("Pagination"),M=(0,a.up)("StoryModal"),V=(0,a.up)("DelModal");return(0,a.wg)(),(0,a.iD)("div",o,[(0,a.Wm)(x,{active:S.isLoading},null,8,["active"]),(0,a._)("div",i,[(0,a._)("button",{class:"btn btn-primary",type:"button",onClick:e[0]||(e[0]=t=>v.openModal(!0,null))}," 新增文章 ")]),(0,a._)("table",n,[d,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(S.storyList,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",r,(0,s.zw)(t.$filters.dateAndTime(e.create_at)),1),(0,a._)("td",c,(0,s.zw)(e.title),1),(0,a._)("td",p,(0,s.zw)(e.author),1),(0,a._)("td",{class:"d-md-inline-block d-none multiline-ellipsis",innerHTML:e.description},null,8,u),(0,a._)("td",m,[e.isPublic?((0,a.wg)(),(0,a.iD)("span",h,"啟用")):((0,a.wg)(),(0,a.iD)("span",y,"未啟用"))]),(0,a._)("td",g,[(0,a._)("div",_,[(0,a._)("button",{class:"btn btn-outline-primary btn-sm",onClick:t=>v.openModal(!1,e.id)},"編輯",8,b),(0,a._)("button",{class:"btn btn-outline-danger btn-sm",onClick:t=>v.openDelStoryModal(e)},"刪除",8,f)])])])))),128))])]),(0,a.Wm)(k,{pages:S.pagination,onEmitPages:v.getStoryList},null,8,["pages","onEmitPages"]),(0,a.Wm)(M,{ref:"storyModal",story:S.tempStory,onUpdateStory:v.updateStory},null,8,["story","onUpdateStory"]),(0,a.Wm)(V,{item:S.tempStory,ref:"delModal",onDelItem:v.delStory},null,8,["item","onDelItem"])])}var S=l(9242);const v={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},x={class:"modal-dialog modal-xl",role:"document"},k={class:"modal-content border-0"},M=(0,a._)("div",{class:"modal-header bg-dark text-white"},[(0,a._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,a._)("span",null,"新增文章")]),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),V={class:"modal-body"},C={class:"row"},L={class:"col-sm-4"},$={class:"mb-3"},D=(0,a._)("label",{for:"image",class:"form-label"},"輸入圖片網址",-1),U={class:"mb-3"},T={for:"customFile",class:"form-label"},I=(0,a.Uk)("或 上傳圖片 "),P=["src"],W={class:"col-sm-8"},z={class:"d-flex flex-column gap-3"},F={class:"d-flex flex-column flex-md-row align-items-start gap-1"},N=(0,a._)("p",null,"新增日期",-1),j={class:"d-flex flex-column flex-md-row gap-1"},Z=(0,a._)("p",null,"新增標籤",-1),H=(0,a.Uk)(" + New Tag "),K={class:""},R=(0,a._)("label",{for:"title",class:"form-label"},"標題",-1),A={class:"row gx-2"},B={class:"mb-3 col-md-6"},E=(0,a._)("label",{for:"category",class:"form-label"},"作者",-1),O={class:""},Y=(0,a._)("label",{for:"editor1",class:"form-label"},"文章描述",-1),q={class:""},G=(0,a._)("label",{for:"content",class:"form-label"},"球員內容",-1),J=(0,a._)("hr",null,null,-1),Q={class:""},X={class:"form-check"},tt=(0,a._)("label",{class:"form-check-label",for:"isPublic"}," 是否啟用 ",-1),et={class:"modal-footer"},lt=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function at(t,e,l,o,i,n){const d=(0,a.up)("el-date-picker"),r=(0,a.up)("el-tag"),c=(0,a.up)("el-input"),p=(0,a.up)("el-button"),u=(0,a.up)("ckeditor");return(0,a.wg)(),(0,a.iD)("div",v,[(0,a._)("div",x,[(0,a._)("div",k,[M,(0,a._)("div",V,[(0,a._)("div",C,[(0,a._)("div",L,[(0,a._)("div",$,[D,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"image","onUpdate:modelValue":e[0]||(e[0]=t=>i.tempStory.imageUrl=t),placeholder:"請輸入圖片連結"},null,512),[[S.nr,i.tempStory.imageUrl]])]),(0,a._)("div",U,[(0,a._)("label",T,[I,(0,a._)("i",{class:(0,s.C_)([{"d-none":!i.Loading_small},"fas fa-spinner fa-spin"])},null,2)]),(0,a._)("input",{type:"file",id:"customFile",class:"form-control",ref:"fileInput",onChange:e[1]||(e[1]=(...t)=>n.uploadFile&&n.uploadFile(...t))},null,544)]),(0,a._)("img",{class:"of-cover op-top w-100",style:{},src:i.tempStory.imageUrl,alt:""},null,8,P)]),(0,a._)("div",W,[(0,a._)("div",z,[(0,a._)("div",F,[N,(0,a.Wm)(d,{modelValue:i.create_at,"onUpdate:modelValue":e[2]||(e[2]=t=>i.create_at=t),type:"datetime",placeholder:"Select date and time",shortcuts:i.shortcuts},null,8,["modelValue","shortcuts"])]),(0,a._)("div",j,[Z,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.dynamicTags,(t=>((0,a.wg)(),(0,a.j4)(r,{key:t,class:"mx-1",closable:"","disable-transitions":!1,onClose:e=>n.handleClose(t)},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(t),1)])),_:2},1032,["onClose"])))),128)),i.inputVisible?((0,a.wg)(),(0,a.j4)(c,{key:0,ref:"InputRef",modelValue:i.inputValue,"onUpdate:modelValue":e[3]||(e[3]=t=>i.inputValue=t),class:"ms-1",style:{width:"100px"},size:"small",onKeyup:(0,S.D2)(n.handleInputConfirm,["enter"]),onBlur:n.handleInputConfirm},null,8,["modelValue","onKeyup","onBlur"])):((0,a.wg)(),(0,a.j4)(p,{key:1,class:"button-new-tag ml-1",size:"small",onClick:(0,S.iM)(n.showInput,["stop"])},{default:(0,a.w5)((()=>[H])),_:1},8,["onClick"]))]),(0,a._)("div",K,[R,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":e[4]||(e[4]=t=>i.tempStory.title=t),placeholder:"請輸入標題"},null,512),[[S.nr,i.tempStory.title]])]),(0,a._)("div",A,[(0,a._)("div",B,[E,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"category","onUpdate:modelValue":e[5]||(e[5]=t=>i.tempStory.author=t),placeholder:"請輸入分類"},null,512),[[S.nr,i.tempStory.author]])])]),(0,a._)("div",O,[Y,(0,a.Wm)(u,{editor:i.editor,modelValue:i.tempStory.description,"onUpdate:modelValue":e[6]||(e[6]=t=>i.tempStory.description=t),config:i.editorConfig},null,8,["editor","modelValue","config"])]),(0,a._)("div",q,[G,(0,a.Wm)(u,{editor:i.editor,modelValue:i.tempStory.content,"onUpdate:modelValue":e[7]||(e[7]=t=>i.tempStory.content=t),config:i.editorConfig},null,8,["editor","modelValue","config"])]),J,(0,a._)("div",Q,[(0,a._)("div",X,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=t=>i.tempStory.isPublic=t),"true-value":!0,"false-value":!1,id:"isPublic"},null,512),[[S.e8,i.tempStory.isPublic]]),tt])])])])])]),(0,a._)("div",et,[lt,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:e[9]||(e[9]=e=>t.$emit("update-story",i.tempStory))}," 確認 ")])])])],512)}var st=l(1339),ot=l(6713),it=l.n(ot),nt={mixins:[st.Z],data(){return{modal:{},tempStory:{},create_at:"",
//! 限制數字存入資料
shortcuts:[{text:"Today",value:new Date},{text:"Yesterday",value:()=>{const t=new Date;return t.setTime(t.getTime()-864e5),t}},{text:"A week ago",value:()=>{const t=new Date;return t.setTime(t.getTime()-6048e5),t}}],inputValue:"",dynamicTags:["NBA","SPORT","NEWS"],inputVisible:!1,InputRef:null,editor:it(),editorConfig:{},Loading_small:!1}},props:{story:{type:Object,default(){return{}}}},created(){},watch:{story(){this.tempStory=this.story,
//! 用元件的話會自動使用toLocaleString()，就會變成年月日時間，所以只要*1000即可(等於台北時間...之類的)，不能使用this.$filters.dateAndTime
this.create_at=new Date(1e3*this.tempStory.create_at),
//! 結果api文件中的tag欄位m，根本沒有QQ，難怪undefine
this.tempStory.images||(this.tempStory.images=[])},create_at(){
//! 限制數字存入資料
this.tempStory.create_at=Math.floor(new Date(this.create_at)/1e3)}},methods:{uploadFile(){this.Loading_small=!0;const t=this.$refs.fileInput.files[0],e=new FormData;e.append("file-to-upload",t);const l="https://vue3-course-api.hexschool.io/api/william-api/admin/upload";this.$http.post(l,e).then((t=>{console.log(t),t.data.success&&(this.tempStory.imageUrl=t.data.imageUrl,this.Loading_small=!1)}))},handleClose(t){this.dynamicTags.splice(this.dynamicTags.indexOf(t),1)},showInput(){this.inputVisible=!0,this.$nextTick((()=>{this.$refs.InputRef.focus()}))},handleInputConfirm(){this.inputValue&&this.dynamicTags.push(this.inputValue),this.inputVisible=!1,this.inputValue=""}}},dt=l(89);const rt=(0,dt.Z)(nt,[["render",at]]);var ct=rt,pt=l(9108),ut=l(7850),mt={components:{StoryModal:ct,DelModal:ut.Z,Pagination:pt.Z},inject:["emitter"],data(){return{storyList:[],pagination:{},tempStory:{},isNew:!1,isLoading:!1}},created(){this.getStoryList()},methods:{getStoryList(t=1){const e=`https://vue3-course-api.hexschool.io/api/william-api/admin/articles/?page=${t}`;this.isLoading=!0,this.$http.get(e).then((t=>{this.isLoading=!1,t.data.success&&(this.storyList=t.data.articles,this.pagination=t.data.pagination)}))},
//! 新增時會帶一個true，編輯時會帶false和資料
openModal(t,e){if(t)this.tempStory={};else{this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/william-api/admin/article/${e}`;this.$http.get(t).then((t=>{t.data.success&&(this.tempStory=t.data.article,this.isLoading=!1)}))}this.isNew=t;const l=this.$refs.storyModal;l.showModal()},updateStory(t){this.tempStory=t;let e="https://vue3-course-api.hexschool.io/api/william-api/admin/article",l="post";this.isNew||(e=`https://vue3-course-api.hexschool.io/api/william-api/admin/article/${t.id}`,l="put");const a=this.$refs.storyModal;this.$http[l](e,{data:this.tempStory}).then((t=>{a.hideModal(),t.data.success?(this.getStoryList(),this.$httpMessageState(t,"更新")):this.$httpMessageState(t,"更新")}))},openDelStoryModal(t){this.tempStory={...t};const e=this.$refs.delModal;e.showModal()},delStory(){const t=`https://vue3-course-api.hexschool.io/api/william-api/admin/article/${this.tempStory.id}`;this.$http.delete(t).then((t=>{this.$httpMessageState(t,t.data.message);const e=this.$refs.delModal;e.hideModal(),this.getStoryList()}))}}};const ht=(0,dt.Z)(mt,[["render",w]]);var yt=ht}}]);
//# sourceMappingURL=770.624b6343.js.map