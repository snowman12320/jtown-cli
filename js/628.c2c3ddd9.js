"use strict";(self["webpackChunkhello_world"]=self["webpackChunkhello_world"]||[]).push([[628],{7418:function(t,e,i){var s=i(9806);e["Z"]={inject:["emitter"],mixins:[s.Z],data(){return{qty:1,status:{loadingItem:""},productSize_list:"",productSize_item:""}},methods:{addToCart(t,e=1,i){if(this.isLogin)if(this.productSize_list||this.productSize_item){this.status.loadingItem=t,this.isLoading=!0;const s="https://vue3-course-api.hexschool.io/api/william-api/cart",a={product_id:t,qty:e};this.$http.post(s,{data:a}).then((t=>{this.isLoading=!1,this.status.loadingItem="",this.$toast("success","add to cart."),this.emitter.emit("customEvent_getCart",this.getCart),i&&(this.$router.push("/cart-view/cart-list"),this.emitter.emit("customEvent_getCart",this.getCart))}))}else this.$swal.fire("Please","Size must be selectd.","warning");else this.$swal.fire("Please"," Sign in or Sign up first.","warning"),this.$router.push("/login")}}}},6019:function(t,e,i){var s=i(9806);e["Z"]={inject:["emitter"],mixins:[s.Z],data(){return{isFavorite:!1,favoriteData:[],checkFavorite:!1}},created(){this.getFavoriteData();//! 用其他電腦，先新增本地陣列
},methods:{updateFavo(t){if(this.isLoading=!0,this.checkFavorite=Boolean(-1!==localStorage.getItem("favorite").indexOf(t)),this.checkFavorite){this.isFavorite=!1,this.$toast("success","delete favorite."),this.favoriteData=JSON.parse(localStorage.getItem("favorite"));const e=this.favoriteData.indexOf(t);e>-1&&(this.favoriteData.splice(e,1),localStorage.setItem("favorite",JSON.stringify(this.favoriteData))),this.isLoading=!1}else this.isFavorite=!0,this.$toast("success","add to favorite."),this.favoriteData.push(t),localStorage.setItem("favorite",JSON.stringify(this.favoriteData));this.emitter.emit("customEvent_updateFavorite"),//! 觸發收藏表更新
this.isLoading=!1},getFavoriteData(){if(localStorage.getItem("favorite")){this.favoriteData=JSON.parse(localStorage.getItem("favorite"));const t=Boolean(-1!==JSON.parse(localStorage.getItem("favorite")).indexOf(this.id));this.isFavorite=!!t}else localStorage.setItem("favorite",JSON.stringify(this.favoriteData))}}}},628:function(t,e,i){i.d(e,{Z:function(){return H}});var s=i(3396),a=i(7139),o=i(9242);const r=t=>((0,s.dD)("data-v-0a9cd63c"),t=t(),(0,s.Cn)(),t),c={class:""},l=r((()=>(0,s._)("label",{for:"",class:"form-label mb-0"},"Sort by：",-1))),d=(0,s.uE)('<option class="fs-6" value="0" selected data-v-0a9cd63c>Relevance</option><option class="fs-6" value="AZ" data-v-0a9cd63c>Name - AZ</option><option class="fs-6" value="ZA" data-v-0a9cd63c>Name - ZA</option><option class="fs-6" value="Low" data-v-0a9cd63c>Price - Low to Height</option><option class="fs-6" value="Height" data-v-0a9cd63c>Price - Height to Low</option>',5),n=[d],h=r((()=>(0,s._)("hr",{class:"py-3"},null,-1))),u={class:"row row-cols-2 row-cols-lg-5 g-4 mb-7",ref:"products_list"},p={class:"col overflow-hidden"},g={class:"fw-light",style:{"font-size":"10px"}},m=["onClick"],f={class:"text-white text-center"},v={class:"position-relative border border-white rounded-1 px-2 py-3 bg-transparent d-flex justify-content-around m-2"},_=["onClick"],w={class:"d-flex justify-content-center w-100 mx-auto gap-1"},y={class:""},S={class:""},b={class:""},L={class:"slanted-div"},C=r((()=>(0,s._)("label",{style:{cursor:"not-allowed"},disabled:"",class:"form-check-label border border-secondary text-secondary fs-6 px-2 py-1",for:"list_XL"}," xL ",-1))),x=["onClick"],k={key:0,class:"text-center d-flex align-items-center justify-content-center position-absolute top-0 start-0 end-0 bottom-0"},F=r((()=>(0,s._)("div",{class:"spinner-border text-primary",role:"status"},[(0,s._)("span",{class:"visually-hidden"},"Loading...")],-1))),z=[F],$=["src","alt"],D={class:"text-center"},E={class:"spinner-grow text-warning",role:"status"},I=r((()=>(0,s._)("span",{class:"visually-hidden"},"Loading...",-1))),Z=[I];function O(t,e,i,r,d,F){const I=(0,s.up)("el-popover");return(0,s.wg)(),(0,s.iD)("div",c,[(0,s._)("div",{class:(0,a.C_)(["mb-3 d-flex justify-content-end align-items-center",i.customClass])},[l,(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>d.selectSort=t),class:"form-select form-select-lg rounded-0 p-1 fs-6",style:{width:"250px"},name:"",id:""},n,512),[[o.bM,d.selectSort]])],2),h,(0,s._)("div",u,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(F.filtersData,((i,r)=>((0,s.wg)(),(0,s.iD)("div",{class:"",key:i.id},[(0,s._)("div",p,[(0,s._)("div",{class:(0,a.C_)(["card w-100 position-relation newproduct_img",{"overflow-hidden":d.setClass===r}]),"data-num":"1"},[(0,s._)("div",{class:(0,a.C_)(["newproduct_cloth p-1",{newproduct_cloth_set:d.setClass===r}]),ref_for:!0,ref:"newproduct_cloth"},[(0,s._)("h6",g,(0,a.zw)(i.category),1),(0,s._)("h5",{class:"fs-5 text-center",onClick:t=>F.getProduct(i.id)},(0,a.zw)(i.title),9,m),(0,s._)("h6",f," $ "+(0,a.zw)(t.$filters.currency(i.price)),1),(0,s._)("div",v,[(0,s._)("i",{onClick:e=>t.updateFavo(i.id),class:(0,a.C_)([{"text-danger":-1!==t.favoriteData.indexOf(i.id)},"fa fa-heart fs-4"])},null,10,_),(0,s.Wm)(I,{placement:"top",title:"SIZE：",width:200,trigger:"hover",content:"",onHide:e[5]||(e[5]=t=>d.setClass=!1),onShow:t=>d.setClass=r},{reference:(0,s.w5)((()=>[(0,s._)("i",{onClick:e=>t.addToCart(i.id,t.qty,t.isBuy=!1),class:"fa fa-cart-plus text-white fs-4"},null,8,x)])),default:(0,s.w5)((()=>[(0,s._)("div",w,[(0,s._)("div",y,[(0,s.wy)((0,s._)("input",{value:"S","onUpdate:modelValue":e[1]||(e[1]=e=>t.productSize_list=e),class:"form-check-input d-none",type:"radio",name:"size",id:"list_S"},null,512),[[o.G2,t.productSize_list]]),(0,s._)("label",{style:{cursor:"pointer"},class:(0,a.C_)([{"bg-black text-white":"S"===t.productSize_list},"form-check-label border border-secondary text-secondary fs-6 px-2 py-1"]),for:"list_S"}," S ",2)]),(0,s._)("div",S,[(0,s.wy)((0,s._)("input",{value:"M","onUpdate:modelValue":e[2]||(e[2]=e=>t.productSize_list=e),class:"form-check-input d-none",type:"radio",name:"size",id:"list_M"},null,512),[[o.G2,t.productSize_list]]),(0,s._)("label",{style:{cursor:"pointer"},class:(0,a.C_)([{"bg-black text-white":"M"===t.productSize_list},"form-check-label border border-secondary text-secondary fs-6 px-2 py-1"]),for:"list_M"}," M ",2)]),(0,s._)("div",b,[(0,s.wy)((0,s._)("input",{value:"L","onUpdate:modelValue":e[3]||(e[3]=e=>t.productSize_list=e),class:"form-check-input d-none",type:"radio",name:"size",id:"list_L"},null,512),[[o.G2,t.productSize_list]]),(0,s._)("label",{style:{cursor:"pointer"},class:(0,a.C_)([{"bg-black text-white":"L"===t.productSize_list},"form-check-label border border-secondary text-secondary fs-6 px-2 py-1"]),for:"list_L"}," L ",2)]),(0,s._)("div",L,[(0,s.wy)((0,s._)("input",{disabled:"",value:"XL","onUpdate:modelValue":e[4]||(e[4]=e=>t.productSize_list=e),class:"form-check-input d-none",type:"radio",name:"size",id:"list_XL"},null,512),[[o.G2,t.productSize_list]]),C])])])),_:2},1032,["onShow"]),d.isLoading?((0,s.wg)(),(0,s.iD)("div",k,z)):(0,s.kq)("",!0)])],2),(0,s._)("img",{"data-num":"1",height:"312",width:"312",class:"card-img of-cover op-top",src:i.imageUrl,alt:i.title},null,8,$)],2)])])))),128))],512),(0,s._)("div",D,[(0,s.wy)((0,s._)("div",E,Z,512),[[o.F8,d.isLoading]])])])}var P=i(7418),N=i(6019),J={mixins:[P.Z,N.Z],inject:["emitter"],data(){return{products:[],Filtered:[],
//! 搜尋全域的資料
page:1,pagination:{},products_list:0,isLoading:!1,id:"",product:{},cacheSearch:"",cacheCategory:"",filterCheck:"",isFavorite:!1,selectSort:"0",setClass:!1}},props:["customClass"],mounted(){this.products_list=this.$refs.products_list.offsetHeight,//! 在mounted定義會是零，但不定義會在其他頁報錯
window.addEventListener("scroll",this.handleScroll),this.emitter.on("customEvent_search",(t=>{this.cacheSearch=t})),this.emitter.on("customEvent_category",(t=>{this.cacheCategory=t,this.cacheSearch=""})),this.emitter.on("customEvent_Check",(t=>{this.filterCheck=t}))},created(){this.cacheSearch=this.$route.params.search,this.getProducts(),this.getFiltered()},computed:{filtersData(){let t=[];this.isLoading_big=!0;try{if(this.$route.path.includes("products-content")||this.$route.path.includes("products-item")){t=this.Filtered.filter((t=>(!this.cacheSearch||t.title.toLowerCase().includes(this.cacheSearch.trim().toLowerCase()))&&(!this.cacheCategory||t.category.toLowerCase().includes(this.cacheCategory.trim().toLowerCase())))),0===t.length&&(t=this.products),this.cacheCategory||this.cacheSearch||(t=this.products);const e={2999:t=>t.price<=2999,5e3:t=>t.price>=5e3,default:()=>!0}[this.filterCheck||"default"],i={Low:(t,e)=>t.price-e.price,Height:(t,e)=>e.price-t.price,AZ:(t,e)=>t.title.localeCompare(e.title),ZA:(t,e)=>e.title.localeCompare(t.title),default:()=>0}[this.selectSort||"default"];t=t.filter(e).sort(i)}else t=this.products}finally{
//! 無法在 computed 屬性中使用了副作用 (想嘗試改變 isLoading_big 時機)
this.isLoading_big=!1}return t}},methods:{handleScroll(){window.scrollY>this.products_list-300&&
//!
this.pushProducts()},getFiltered(){const t="https://vue3-course-api.hexschool.io/api/william-api/products/all";this.$http.get(t).then((t=>{t.data.success&&(this.Filtered=t.data.products)}))},getProducts(t=1){const e=`https://vue3-course-api.hexschool.io/api/william-api/products/?page=${t}`;this.isLoading=!0,this.isLoading_big=!0,this.emitter.emit("customEvent_isLoading_big",this.isLoading_big),this.$http.get(e).then((t=>{this.isLoading=!1,this.isLoading_big=!1,this.emitter.emit("customEvent_isLoading_big",this.isLoading_big),t.data.success&&(this.products=t.data.products,this.pagination=t.data.pagination)}))},pushProducts(){
//! 要用this.isLoading阻擋，避免讀取api間隔，持續捲動導致重複讀取資料
if(!this.isLoading&&this.pagination.has_next){this.isLoading=!0,this.page++;const t=`https://vue3-course-api.hexschool.io/api/william-api/products/?page=${this.page}`;this.$http.get(t).then((t=>{t.data.success&&(this.pagination=t.data.pagination,this.products=this.products.concat(t.data.products),
//! 成功讀取分頁數後，才能關閉載入，進行下次資料儲存，否則會重複儲存
this.isLoading=!1)}))}},getProduct(t){
//! 只取一個商品
this.$router.push(`/products-view/products-item/${t}`),this.isLoading=!0,this.isLoading_big=!0,this.emitter.emit("customEvent_isLoading_big",this.isLoading_big);const e=`https://vue3-course-api.hexschool.io/api/william-api/product/${t}`;
//! 要用this.id ，用product.id會錯 ，需分清楚差別
//! 在其他電腦，若先判斷會錯誤
if(this.$http.get(e).then((t=>{if(this.isLoading=!1,this.isLoading_big=!1,this.emitter.emit("customEvent_isLoading_big",this.isLoading_big),t.data.success){this.product=t.data.product,this.emitter.emit("customEvent_getProduct",this.product);const e=document.querySelectorAll(".carousel-item");e.forEach((function(t){t.classList.remove("active")})),e[0].classList.add("active"),window.scrollTo(0,0)}})),JSON.parse(localStorage.getItem("favorite"))){const e=Boolean(-1!==JSON.parse(localStorage.getItem("favorite")).indexOf(t));e?(this.isFavorite=!0,this.emitter.emit("customEvent_isFavorite",this.isFavorite)):(this.isFavorite=!1,this.emitter.emit("customEvent_isFavorite",this.isFavorite))}}}},j=i(89);const A=(0,j.Z)(J,[["render",O],["__scopeId","data-v-0a9cd63c"]]);var H=A}}]);
//# sourceMappingURL=628.c2c3ddd9.js.map