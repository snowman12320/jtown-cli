"use strict";(self["webpackChunkhello_world"]=self["webpackChunkhello_world"]||[]).push([[788],{6173:function(t,e,a){a.d(e,{Z:function(){return f}});var l=a(3396),s=a(9242),i=a(7139);const o={"aria-label":"Page navigation example"},n={class:"pagination justify-content-center"},r={class:"page-item"},p=(0,l._)("span",{"aria-hidden":"true"},"«",-1),d=[p],c=["onClick"],u={class:"page-item"},m=(0,l._)("span",{"aria-hidden":"true"},"»",-1),h=[m];function y(t,e,a,p,m,y){return(0,l.wg)(),(0,l.iD)("nav",o,[(0,l._)("ul",n,[(0,l._)("li",r,[(0,l._)("a",{onClick:e[0]||(e[0]=(0,s.iM)((t=>y.prevPage(a.pages.current_page)),["prevent"])),class:(0,i.C_)([{"text-secondary disabled":!a.pages.has_pre},"page-link"]),href:"#","aria-label":"Previous"},d,2)]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.pages.total_pages,(t=>((0,l.wg)(),(0,l.iD)("li",{class:(0,i.C_)(["page-item",{active:t===a.pages.current_page}]),key:t},[(0,l._)("a",{class:"page-link",href:"#",onClick:(0,s.iM)((e=>y.updatePage(t)),["prevent"])},(0,i.zw)(t),9,c)],2)))),128)),(0,l._)("li",u,[(0,l._)("a",{onClick:e[1]||(e[1]=(0,s.iM)((t=>y.nextPage(a.pages.current_page)),["prevent"])),class:(0,i.C_)({"text-secondary disabled":!a.pages.has_next}),href:"#","aria-label":"Next"},h,2)])])])}var g={props:["pages"],methods:{updatePage(t){this.$emit("emit-pages",t)},prevPage(t){this.pages.has_pre&&this.$emit("emit-pages",t-=1)},nextPage(t){this.pages.has_next&&this.$emit("emit-pages",t+=1)}}},_=a(89);const b=(0,_.Z)(g,[["render",y]]);var f=b},6788:function(t,e,a){a.r(e),a.d(e,{default:function(){return pt}});var l=a(3396),s=a(7139);const i={class:""},o={class:"text-end mt-3"},n={class:"table mt-4"},r=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",{width:"120"},"日期"),(0,l._)("th",{width:"120"},"標題"),(0,l._)("th",{width:"120"},"作者"),(0,l._)("th",{width:"120"},"內容"),(0,l._)("th",{width:"120"},"內容"),(0,l._)("th",{width:"100"},"是否啟用"),(0,l._)("th",{width:"200"},"編輯")])],-1),p={class:"multiline-ellipsis"},d={key:0,class:"text-success"},c={key:1,class:"text-muted"},u={class:"btn-group"},m=["onClick"],h=["onClick"];function y(t,e,a,y,g,_){const b=(0,l.up)("Loading"),f=(0,l.up)("Pagination"),w=(0,l.up)("StoryModal"),S=(0,l.up)("DelModal");return(0,l.wg)(),(0,l.iD)("div",i,[(0,l.Wm)(b,{active:g.isLoading},null,8,["active"]),(0,l._)("div",o,[(0,l._)("button",{class:"btn btn-primary",type:"button",onClick:e[0]||(e[0]=t=>_.openModal(!0))}," 新增文章 ")]),(0,l._)("table",n,[r,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(g.storyList,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id},[(0,l._)("td",null,(0,s.zw)(t.$filters.date(e.create_at)),1),(0,l._)("td",null,(0,s.zw)(e.title),1),(0,l._)("td",null,(0,s.zw)(e.author),1),(0,l._)("td",p,(0,s.zw)(e.description),1),(0,l._)("td",null,(0,s.zw)(e.content),1),(0,l._)("td",null,[e.isPublic?((0,l.wg)(),(0,l.iD)("span",d,"啟用")):((0,l.wg)(),(0,l.iD)("span",c,"未啟用"))]),(0,l._)("td",null,[(0,l._)("div",u,[(0,l._)("button",{class:"btn btn-outline-primary btn-sm",onClick:t=>_.openModal(!1,e.id)},"編輯",8,m),(0,l._)("button",{class:"btn btn-outline-danger btn-sm",onClick:t=>_.openDelStoryModal(e)},"刪除",8,h)])])])))),128))])]),(0,l.Wm)(f,{pages:g.pagination,onEmitPages:_.getStoryList},null,8,["pages","onEmitPages"]),(0,l.Wm)(w,{ref:"storyModal",story:g.tempStory,onUpdateStory:_.updateStory},null,8,["story","onUpdateStory"]),(0,l.Wm)(S,{item:g.tempStory,ref:"delModal",onDelItem:_.delStory},null,8,["item","onDelItem"])])}var g=a(9242);const _={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},b={class:"modal-dialog modal-xl",role:"document"},f={class:"modal-content border-0"},w=(0,l._)("div",{class:"modal-header bg-dark text-white"},[(0,l._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,l._)("span",null,"新增文章")]),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),S={class:"modal-body"},v={class:"row"},k={class:"col-sm-4"},x={class:"mb-3"},M=(0,l._)("label",{for:"image",class:"form-label"},"輸入圖片網址",-1),C={class:"mb-3"},D=(0,l._)("label",{for:"customFile",class:"form-label"},[(0,l.Uk)("或 上傳圖片 "),(0,l._)("i",{class:"fas fa-spinner fa-spin"})],-1),$=["src"],V={key:0,class:"mt-5"},U=["onUpdate:modelValue"],P=["onClick"],L={key:0},I={class:"col-sm-8"},z={class:"mb-3"},T=(0,l.Uk)(" + New Tag "),N={class:"mb-3"},Z=(0,l._)("label",{for:"title",class:"form-label"},"標題",-1),j={class:"row gx-2"},F={class:"mb-3 col-md-6"},K=(0,l._)("label",{for:"category",class:"form-label"},"作者",-1),W={class:"mb-3"},H=(0,l._)("label",{for:"editor1",class:"form-label"},"內文",-1),O={class:"mb-3"},R=(0,l._)("label",{for:"content",class:"form-label"},"內文",-1),Y=(0,l._)("hr",null,null,-1),B={class:"mb-3"},E=(0,l._)("label",{for:"create_at"},"新增日期",-1),q={class:"mb-3"},A={class:"form-check"},G=(0,l._)("label",{class:"form-check-label",for:"isPublic"}," 是否啟用 ",-1),J={class:"modal-footer"},Q=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function X(t,e,a,i,o,n){const r=(0,l.up)("el-tag"),p=(0,l.up)("el-input"),d=(0,l.up)("el-button");return(0,l.wg)(),(0,l.iD)("div",_,[(0,l._)("div",b,[(0,l._)("div",f,[w,(0,l._)("div",S,[(0,l._)("div",v,[(0,l._)("div",k,[(0,l._)("div",x,[M,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"image","onUpdate:modelValue":e[0]||(e[0]=t=>o.tempStory.imageUrl=t),placeholder:"請輸入圖片連結"},null,512),[[g.nr,o.tempStory.imageUrl]])]),(0,l._)("div",C,[D,(0,l._)("input",{type:"file",id:"customFile",class:"form-control",ref:"fileInput",onChange:e[1]||(e[1]=(...t)=>n.uploadFile&&n.uploadFile(...t))},null,544)]),(0,l._)("img",{class:"img-fluid",src:o.tempStory.imageUrl,alt:""},null,8,$),o.tempStory.images?((0,l.wg)(),(0,l.iD)("div",V,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o.tempStory.images,((t,e)=>((0,l.wg)(),(0,l.iD)("div",{class:"mb-3 input-group",key:e},[(0,l.wy)((0,l._)("input",{type:"url",class:"form-control form-control","onUpdate:modelValue":t=>o.tempStory.images[e]=t,placeholder:"請輸入連結"},null,8,U),[[g.nr,o.tempStory.images[e]]]),(0,l._)("button",{type:"button",class:"btn btn-outline-danger",onClick:t=>o.tempStory.images.splice(e,1)}," 移除 ",8,P)])))),128)),o.tempStory.images[o.tempStory.images.length-1]||!o.tempStory.images.length?((0,l.wg)(),(0,l.iD)("div",L)):(0,l.kq)("",!0)])):(0,l.kq)("",!0)]),(0,l._)("div",I,[(0,l._)("div",z,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o.dynamicTags,(t=>((0,l.wg)(),(0,l.j4)(r,{key:t,class:"mx-1",closable:"","disable-transitions":!1,onClose:e=>n.handleClose(t)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(t),1)])),_:2},1032,["onClose"])))),128)),o.inputVisible?((0,l.wg)(),(0,l.j4)(p,{key:0,ref:"InputRef",modelValue:o.inputValue,"onUpdate:modelValue":e[2]||(e[2]=t=>o.inputValue=t),class:"ms-1",style:{width:"100px"},size:"small",onKeyup:(0,g.D2)(n.handleInputConfirm,["enter"]),onBlur:n.handleInputConfirm},null,8,["modelValue","onKeyup","onBlur"])):((0,l.wg)(),(0,l.j4)(d,{key:1,class:"button-new-tag ml-1",size:"small",onClick:(0,g.iM)(n.showInput,["stop"])},{default:(0,l.w5)((()=>[T])),_:1},8,["onClick"]))]),(0,l._)("div",N,[Z,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":e[3]||(e[3]=t=>o.tempStory.title=t),placeholder:"請輸入標題"},null,512),[[g.nr,o.tempStory.title]])]),(0,l._)("div",j,[(0,l._)("div",F,[K,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"category","onUpdate:modelValue":e[4]||(e[4]=t=>o.tempStory.author=t),placeholder:"請輸入分類"},null,512),[[g.nr,o.tempStory.author]])])]),(0,l._)("div",W,[H,(0,l.wy)((0,l._)("textarea",{type:"text",class:"form-control","onUpdate:modelValue":e[5]||(e[5]=t=>o.tempStory.description=t),placeholder:"請輸入文章內容"},null,512),[[g.nr,o.tempStory.description]])]),(0,l._)("div",O,[R,(0,l.wy)((0,l._)("textarea",{type:"text",class:"form-control",id:"content","onUpdate:modelValue":e[6]||(e[6]=t=>o.tempStory.content=t),placeholder:"請輸入文章內容"},null,512),[[g.nr,o.tempStory.content]])]),Y,(0,l._)("div",B,[E,(0,l.wy)((0,l._)("input",{type:"date",class:"form-control",id:"create_at","onUpdate:modelValue":e[7]||(e[7]=t=>o.create_at=t)},null,512),[[g.nr,o.create_at]])]),(0,l._)("div",q,[(0,l._)("div",A,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=t=>o.tempStory.isPublic=t),"true-value":!0,"false-value":!1,id:"isPublic"},null,512),[[g.e8,o.tempStory.isPublic]]),G])])])])]),(0,l._)("div",J,[Q,(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:e[9]||(e[9]=e=>t.$emit("update-story",o.tempStory))}," 確認 ")])])])],512)}var tt=a(1339),et={mixins:[tt.Z],data(){return{modal:{},tempStory:{},create_at:"",
//! 限制數字存入資料
inputValue:"",dynamicTags:["NBA","SPORT","NEWS"],inputVisible:!1,InputRef:null}},props:{story:{type:Object,default(){return{}}}},watch:{story(){this.tempStory=this.story;const t=new Date(1e3*this.tempStory.create_at);this.create_at=t.toISOString().split("T")[0],
//! 結果api文件中的tag欄位m，根本沒有QQ，難怪undefine
this.tempStory.images||(this.tempStory.images=[])},create_at(){
//! 限制數字存入資料
this.tempStory.create_at=Math.floor(new Date(this.create_at)/1e3)}},methods:{uploadFile(){const t=this.$refs.fileInput.files[0],e=new FormData;e.append("file-to-upload",t);const a="https://vue3-course-api.hexschool.io/api/william-api/admin/upload";this.$http.post(a,e).then((t=>{console.log(t),t.data.success&&(this.tempStory.imageUrl=t.data.imageUrl)}))},handleClose(t){this.dynamicTags.splice(this.dynamicTags.indexOf(t),1)},showInput(){this.inputVisible=!0,this.$nextTick((()=>{this.$refs.InputRef.focus()}))},handleInputConfirm(){this.inputValue&&this.dynamicTags.push(this.inputValue),this.inputVisible=!1,this.inputValue=""}}},at=a(89);const lt=(0,at.Z)(et,[["render",X]]);var st=lt,it=a(6173),ot=a(6799),nt={components:{StoryModal:st,DelModal:ot.Z,Pagination:it.Z},inject:["emitter"],data(){return{storyList:[],pagination:{},tempStory:{},isNew:!1,isLoading:!1}},created(){this.getStoryList()},methods:{getStoryList(t=1){const e=`https://vue3-course-api.hexschool.io/api/william-api/admin/articles/?page=${t}`;this.isLoading=!0,this.$http.get(e).then((t=>{this.isLoading=!1,t.data.success&&(this.storyList=t.data.articles,this.pagination=t.data.pagination)}))},
//! 新增時會帶一個true，編輯時會帶false和資料
openModal(t,e){if(t)this.tempStory={};else{this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/william-api/admin/article/${e}`;this.$http.get(t).then((t=>{t.data.success&&(this.tempStory=t.data.article,this.isLoading=!1)}))}this.isNew=t;const a=this.$refs.storyModal;a.showModal()},updateStory(t){this.tempStory=t;let e="https://vue3-course-api.hexschool.io/api/william-api/admin/article",a="post";this.isNew||(e=`https://vue3-course-api.hexschool.io/api/william-api/admin/article/${t.id}`,a="put");const l=this.$refs.storyModal;this.$http[a](e,{data:this.tempStory}).then((t=>{l.hideModal(),t.data.success?(this.getStoryList(),this.$httpMessageState(t,"更新")):this.$httpMessageState(t,"更新")}))},openDelStoryModal(t){this.tempStory={...t};const e=this.$refs.delModal;e.showModal()},delStory(){const t=`https://vue3-course-api.hexschool.io/api/william-api/admin/article/${this.tempStory.id}`;this.$http.delete(t).then((t=>{const e=this.$refs.delModal;e.hideModal(),this.getStoryList()}))}}};const rt=(0,at.Z)(nt,[["render",y]]);var pt=rt}}]);
//# sourceMappingURL=788.baee3637.js.map